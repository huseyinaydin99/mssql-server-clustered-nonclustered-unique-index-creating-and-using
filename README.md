# mssql-server-clustered-nonclustered-unique-index-creating-and-using
```
MSSQL Server üzerinde verileri çok performanslı bir şekilde kullanabilmek adına index'ler üzerinde çalışmalar yapıyorum.
Clustered, nonclustered ve unique index yapılarını öğrendim.
```

```
SET STATISTICS IO ON;
SELECT *
FROM [CARPLATES].[dbo].[PLATES]
WHERE BRAND LIKE '%Tof%';

--79544 YUKARIDAKI SELECT SORGUSU 79544 ADET SAYFA(PAGE) OKUMUS.
SELECT 79544 * 8 --BU SORGU 79544 ADET SAYFA(PAGE)'NIN KB KARSILIGI DEMEKTIR.
SELECT 79544 * 8 / 1024 --BU SORGU 79544 ADET SAYFA(PAGE)'NIN MB KARSILIGI DEMEKTIR.
SELECT 79544 * 8 / 1024.01 --BU SORGU 79544 ADET SAYFA(PAGE)'NIN MB KARSILIGI DEMEKTIR. YUVARLAMASIZ HALI .01 EKLENDI.

SP_SPACEUSED 'PLATES'; --ILGILI TABLO HAKKINDA DEPOLAMA BILGILERINI GETIRIR. KAC KB YER KAPLIYOR? KAC SATIRDAN OLUSUYOR VS. GIBI.

SET STATISTICS IO ON;
SELECT *
FROM PLATES
WHERE YEAR_ = '2019';

--NONCLUSTERED INDEX YANI FIZIKSEL OLARAK SIRAYA SOKULMAMIS INDEX DEMEKTIR.
--CLUSTERED INDEX FIZIKSEL SIRALAMALI INDEX'TIR ID KOLUNU CLUSTERED'DIR.
--ID KOLONU OTOMATIK ARTTIGI ICIN SIRALAMALIDIR YANI CLUSTEREDTIR!
--BIZ YENI BIR NONCLUSTERED INDEX EKLEYIP DIGER KOLONLARI INCLUDE(DAHIL) EDERSEK TABLO BOYUTU 
--YAKLASIK 2 KAT BUYUR.
--NONCLUSTERED INDEX OLUSTURMA SCRIPTI:
CREATE NONCLUSTERED INDEX IX1 ON PLATES(
YEAR_
);

--BU SELECT SORGUSU CITYNR KOLONUNA GORE INDEX VARSA 1479 ADET SAYFA(PAGE) OKUYOR.
--BU SELECT SORGUSU CITYNR KOLONUNA GORE INDEX YOKSA 77904 ADET SAYFA(PAGE) OKUYOR.
SELECT 77904 * 8 / 1024.01 --BUDA DEMEK OLUYOR KI 608 MB VERI.
SELECT 1479 * 8 / 1024.01 --BUDA DEMEK OLUYOR KI 11 MB VERI.
--11 MB OLMASI YUKSEK HIZLI TREN DEMEKTIR BUYUUUUUK VERILERDE. (:
SET STATISTICS IO ON;
SELECT *
FROM PLATES
WHERE CITYNR = 33;

USE [CARPLATES]
GO
CREATE NONCLUSTERED INDEX IX2
ON [dbo].[PLATES] ([CITYNR])
INCLUDE ([CARID],[PLATE],[LICENCEDATE],[TITLE],[BRAND],[MODEL],[YEAR_],[FUEL],[SHIFTTYPE],[MOTORVOLUME],[MOTORPOWER],[COLOR],[CASETYPE])
GO

--NOT: MSSQL SERVER'A BIRDEN FAZLA INDEX KULLANIMINDA SORGULAMA YAPARKEN
--HANGI INDEX DAHA AZ MALIYETLIYSE SQLSERVER ONU ANLAR VE O EN AZ MALIYETLI INDEX'I KULLANMAYI
--TERCIH EDER. BUDA DEMEK OLUYOR KI HEM ZAMAN HEM DONANIM MALIYETINDEN TASARRUF.

--NOT: UNIQUE INDEX'TE SISTEM ZATEN UNIQUE(BENZERSIZ-AYNISINDAN BIR TANE DAHA OLMAYAN) KAYIT OLDUGUNU
--BILDIGI ICIN DEVAMINI ARAMIYOR CUNKU YOK.
--EGER TABLOMUZDA TCNO GIBI PLAKA GIBI USERNAME GIBI UNIQUE(BENZERSIZ) KOLONLAR VARSA
--VE INDEX OLUSTURULMASI GEREKIYORSA O INDEX UNIQUE OLMALIDIR KI SISTEM PERFORMANSLI CALISSIN.


--BU SELECT SORGUSU CITYNR KOLONUNA GORE INDEX VARSA 3 ADET SAYFA(PAGE) OKUYOR.
--BU SELECT SORGUSU CITYNR KOLONUNA GORE INDEX YOKSA 78270 ADET SAYFA(PAGE) OKUYOR.
SELECT 78270 * 8 / 1024.01 --BUDA DEMEK OLUYOR KI 611 MB VERI.
SELECT 3 * 8 / 1024.01 --BUDA DEMEK OLUYOR KI 0.0234372 MB VERI.
--0 KUSUR MB OLMASI YUKSEK HIZLI TREN DEMEKTIR BUYUUUUUK VERILERDE. (:
--UNIQUE INDEX'LERDE SISTEM AFEDERSINIZ KOPEK GIBI CALISIYOR :D :D :D
SET STATISTICS IO ON;
SELECT *
FROM PLATES
WHERE PLATE = '01 HVH 47';

--BENZERSIZ BIR KOLON ICIN INDEX OLUSTURMA HEMDE DIGER KOLONLARIN INCLUDE(DAHIL) EDILMESI
--KEYLOOKUP YAPMAMASI ICIN
CREATE UNIQUE NONCLUSTERED INDEX IX3 ON PLATES
(
	PLATE ASC
)
INCLUDE([ID],[CARID],[LICENCEDATE],[CITYNR],[TITLE],[BRAND],[MODEL],[YEAR_],[FUEL],[SHIFTTYPE],[MOTORVOLUME],[MOTORPOWER],[COLOR],[CASETYPE]) 
WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF);
```
